{% extends "debate/base.html" %}
{% load staticfiles %}
{% load widget_tweaks %}
{% load martortags %}


{% block title %}Score Debate{% endblock %}


{% block content %}
          {% if related_post.winner_updated %}
          <h2>Debate Scores and Vote Count
          {% else %}
          Score Debate for both teams</h2>
          {% endif %}
          <h3>Debate Topic:</h3>
          <h4><a href="{% url 'debate:debate_detail' related_post.debate_category related_post.id related_post.slug %}">{{ post.post|capfirst }}</a></h4>

          <div class="ui fluid card">
            <div class="content">

              {% if related_post.winner_updated %}

              <h3 class="ui dividing header">Result</h3>

              <table class="ui fluid table">
               <tbody>
                 <tr>
                   <td>Supporting Team Score</td>
                   <td>{{post.st_verdict}} %</td>
                 </tr>
                 <tr>
                   <td>Opposing Team Score</td>
                   <td>{{post.st_verdict}} %</td>
                 </tr>
                 <tr>
                   <td>Winner</td>
                   <td>{{related_post.winner|capfirst}}</td>
                 </tr>
               </tbody>
             </table>

             <h3 class="ui dividing header">Raw Scores</h3>
             <table class="ui fluid table">
              <tbody>
                <tr>
                  <td>Supporting Team Votes</td>
                  <td>{{post.supporting_vote }}</td>
                </tr>

                 <tr>
                   <td>Opposing Team Votes</td>
                   <td>{{post.opposing_vote }}</td>
                 </tr>
                 <tr>
                   <td>Supporting Team Score</td>
                   <td>{% if post.supporting_score %}{{ post.supporting_score }}{% else %}Not used{% endif %}</td>
                 </tr>
                 <tr>
                   <td>Opposing Team Score</td>
                   <td>{% if post.opposing_score %}{{ post.opposing_score }}{% else %}Not used{% endif %}</td>
                 </tr>
                 <tr>
                   <td>Highest Possible Score</td>
                   <td>{{ post.highest_score }}</td>
                 </tr>
               </tbody>
             </table>

             <h3 class="ui dividing header">Judges' Scores/{{post.judge_percent_share}}</h3>
             {% if judge_support_percent or judge_oppose_percent %}
             <table class="ui fluid table">
              <tbody>
                 <tr>
                   <td>Supporting Side</td>
                   <td>{{judge_support_percent}}</td>
                 </tr>

                 <tr>
                   <td>Opposing Side</td>
                   <td>{{judge_oppose_percent}} %</td>
                 </tr>
                 <tr>
                   <td>Observations</td>
                   <td>{% if post.observation %}
                   <p>{{post.observation|safe_markdown}}
                   {% else %}
                   No recorded observation or anomaly.</p>
                   {% endif %}
                 </td>
                 </tr>
               </tbody>
             </table>
             {% else %}
             <div class="meta">No judge involded in debate</div>
             {% endif %}

                  <p><br>Return to <a href="{{ related_post.get_absolute_url }}">debate</a>.<p>
              </div>
            </div>
              {% else %}

            <form class="ui form" action="." method="post">
                  {% csrf_token %}
                <h3 class="ui dividing header">Judges Verdict.</h3>
                <div class="three column fields">
                  <div class="field">
                  <label>Supporting Side Score:</label>
                    {{score_form.supporting_score}}
                  </div>
                  <div class="field">
                  <label>Opposing Side Score:</label>
                  {{score_form.opposing_score}}
                  </div>
                  <div class="field">
                  <label>Highest Possible (Def: 10):</label>
                  {{score_form.highest_score}}
                  </div>
                </div>

                  {{score_form.observation }}
                  <label>Debate Score Summary and Observations. Markdown supported.</label>

                  {% for error in score_form.errors%}
                  <p><strong class="ui red text">{{error}}</strong></p>
                  {% endfor%}

                <div class="content">
                  <div class="two column fields">
                    <div class="field">
                      <label>Voters Percent Share(Default: 70%)</label>
                      {{score_form.vote_percent_share|attr:"disabled"}}
                    </div>
                    <div class="field">
                      <label>Judges Percent Share(Default: 30%)</label>
                      {{score_form.judge_percent_share|attr:"disabled"}}
                    </div>
                  </div>
                  <p>Both currently disabled. Would be enabled in the future.</p>

                  <div class="inline field">
                    <div class="ui checkbox">
                      <input type="checkbox" id="verified" tabindex="0" class="hidden" required="">
                      <label for="verified">I have verified the scores and willing to add it.</label>
                    </div>
                  </div>
                  <br><br>
                    <button type="submit" class="ui basic primary button">Add Scores</button>

                  <p>Verify scores before submission since values cannot be changed after submission</p>
                  <p>Return to <a href="{% url 'debate:debate_detail' related_post.debate_category related_post.id related_post.slug %}">debate</a> without submitting.<p>

                </div>
                </form>
                {{score_form.media}}

        {% endif %}

          </div>

        </div>

{% endblock content %}
